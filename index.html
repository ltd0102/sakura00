<style>
html,body{margin:0;padding:0;height:100%}

body{font-size:62.5%;line-height:2em;color:#333;background:url(matter/bg02.png) repeat;font-family:verdana,arial,'\5FAE\8F6F\96C5\9ED1','\9ED1\4F53'}

h2{font-size:2em;margin:0}div#footerbottom{min-height:100%;height:auto!important;height:100%;position:relative}

#wrap{margin:0 auto;width:960px;padding-bottom:40px}a{color:#333;text-decoration:none}

ul,ol{margin:0;list-style-type:none;padding:0}a:hover,.postdata a:hover,.postdata-single 

a:hover{color:#2564BB}

.clearfix:after{content:".";display:block;height:auto;clear:both;visibility:hidden}
#header{margin:0 auto;padding:20px 0 5px;width:100%;height:50px;background:url(matter/titleunderline.png) bottom repeat-x}

#headercontain{width:960px;height:40px;margin:0 auto}

#blogtitle,#hptitle{margin:0;background-image:url(matter/logo.png);background-repeat:no-repeat;width:350px;height:40px;float:left;overflow:hidden;text-indent:-9999px}

#hptitle{background-position:0 0}#blogtitle{background-position:0 -40px}

#navbar{height:40px;margin:0 40px 0 auto;float:right;font-size:1.6em}

#navbar ul{height:40px;margin:5px 0 0 0;padding:0;float:left;list-style-type:none}

#navbar li{float:left;height:30px;margin:0}

#navbar a{height:28px;padding:7px 15px 0 15px;display:block}

#navbar a:hover{color:#fff;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px;background-color:#999}

#navbar li.current_page_item{height:35px;position:relative;background-color:#eee;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px}

#container{width:680px;margin:20px 10px;float:left}

div.title{margin:0}

div.title-date{width:40px;float:left;height:58px;-moz-border-radius:5px;-webkit-border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px;background-color:#f7f7f7;border:1px solid #999;overflow:hidden}

div.title-date-year,div.title-date-month{color:#fff;height:15px;text-align:center;font-size:1.3em;line-height:15px;background-color:#999}

div.title-date-day{height:28px;text-align:center;font-size:2em;line-height:25px}

h2.title-index-title,h2.title-single-title{margin-left:50px;padding:0 0 5px 10px;border-bottom:2px solid #c00}

h2.title-single-title{border:0;margin:0;font-size:2em}.postdata,.postdata-single{font-size:1.4em;font-weight:normal;margin:5px auto 0 60px;color:#888}

.postdata a,.postdata-single a{color:#888}

.postdata-single{line-height:11pt;background-color:#eee;margin:10px 0;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px}

.popo,.poda{padding:5px 0;padding-left:20px}.popo{border-bottom:1px solid #ddd}

.poda{border-top:1px solid #eff}.post{margin:10px auto 20px;padding-bottom:20px}

.post p{text-indent:2em;margin:.2em 0;line-height:1.5em}

.index-entry{margin:0 auto 0 40px;padding:5px 10px;font-size:1.4em}

.single-entry{margin:0 0 30px 0;padding:5px 30px;font-size:1.4em}

#scrolltop{display:block;font-size:1em;line-height:10pt;text-align:center;padding:3px 5px;color:#ccc;background-color:#eee;border:1px solid #fff;-moz-border-radius:5px;-webikt-border-radius:5px;border-radius:5px;position:fixed;bottom:50px;width:15px;left:50%;margin-left:450px}

#scrolltop:hover{background:#999;color:#fff}.sidebar{margin-top:30px;width:260px;float:left;height:100%}

.sidebar ul{margin:0;padding:0}.widget{margin:0 0 20px 20px;border-bottom:1px dotted #aaa;padding:0;padding-bottom:10px;text-align:center}

.widget h2{padding:0 0 5px 10px;margin:0;border-bottom:1px solid #aaa;text-align:left}

.widget h3{text-align:left;font-size:1.6em;border-left:10px solid #a9d7f9;padding:5px;margin:2px 10px}

.widget img{text-align:center;max-width:200px}.hp-anime-list{width:220px;height:250px;margin:0 10px;float:left}

.hp-anime-list h2{padding-left:10px;height:25px;border-bottom:1px solid #aaa}

.hp-anime-list h2 span{font-size:.7em;float:right;padding-right:10px;font-weight:normal}

.hp-anime-list h2 span a{color:#999}

.hp-anime-list h2 span a:hover{color:#2564BB}.hp-anime-list ul{padding:0 10px;height:225px}

.hp-anime-list ul a{display:block;width:200px;height:40px;margin:5px 0 0}

.hp-news-sidebar{width:430px;height:299px;margin:20px 0 20px 20px;float:left;border-bottom:1px solid #aaa;overflow:hidden}

.hp-news-sidebar h2{padding-left:10px;height:29px;border-bottom:1px solid #aaa}.hp-news-sidebar table{margin:0 auto;font-size:1.4em}

.hp-news-sidebar tr{margin:5px 0}.hp-news-sidebar th{padding:5px 10px;text-align:left;vertical-align:top;width:90px;border-bottom:1px dotted #ccc}

.hp-news-sidebar td{padding:5px 10px;border-bottom:1px dotted #ccc}

#slider{float:left;overflow:auto;width:490px;height:290px;border:5px solid #fefefe;-moz-box-shadow:0 0 3px 1px rgba(0,0,0,.2);-webkit-box-shadow:0 0 3px 1px rgba(0,0,0,.2);box-shadow:0 0 3px 1px rgba(0,0,0,.2);-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px;margin:20px 0}

#slider img{width:490px;height:290px}

#slider ul{position:relative;list-style:none;top:0;left:0;width:100px}

#slider li{float:left;width:490px;height:290px}.pagination{position:absolute;z-index:2;top:370px;left:50%;list-style:none;height:25px;margin-left:-140px;width:110px}

.pagination li{float:right;cursor:pointer;height:14px;width:14px;background-color:#fff;margin:0 8px 0 0;border-radius:7px;box-shadow:inset 1px 1px 2px rgba(0,0,0,.6)}.pagination li:hover,.pagination li.currentpic{background-color:#ccc}

.pagenav{text-align:center;font-family:Times New Roman,'\5B8B\4F53';margin:10px auto;font-size:1.4em;line-height:25px}

.pagenav a,.pagenav a:hover{color:#000;display:inline-block;height:25px;min-width:25px;max-width:70px;background-color:none}

.prepage,.nextpage,.pagenum,.current,.firstpage,.lastpage{display:inline-block;min-width:20px;max-width:60px;height:25px}

.pagenum,.current,.prepage,.nextpage,.firstpage,.lastpage{background-color:#f3f3f3;border:1px solid #a9d7f9;-moz-border-radius:5px;-webkit-border-radius:5px;padding:0 2px;margin:0 5px}.current{background-color:#ccf}

.pagenum:hover,.prepage:hover,.nextpage:hover,.firstpage:hover,.lastpage:hover{color:#000;background-color:#a9d7f9}

.nopage,.nopage:hover{color:#aaa;background-color:#f9f9f9;border-color:#DDF}

#footer{margin-top:-46px;font-size:1em;color:#333;padding-top:5px;text-align:center;height:40px;background-color:#ccc;border-top:1px solid #999;clear:both}

#GeneratedByCssGaga178{transform:rotate(20120714165459deg)}
</style>

</head>
<body>
<div id="footerbottom">
  <div id="wrap" class="clearfix">
			<div class="post">
		<div class="title">
		<h2 class="title-single-title">Sigil正则表达式入门</h2>
		<div class="postdata-single">
		  <div class="poda">发布日期：2013-02-11</div>
		</div>
		</div>
		<div class="single-entry">
<style>
table, td {border:1px solid #ccc}
table {border-collapse:collapse}
td {padding:5px}
td > p {text-indent:0!important}
pre {border:1px dashed #ccc;background:#eee;padding:1em}
td pre {border:none;background:none;padding:0}
</style>

<p>正则表达式，是一种用特殊符号表示文字的方法，主要用在查找和替换方面。</p>
<p>下面的例子可以让你知道正则表达式是干什么用的。</p>
<p>在一个文本中，有这样的一些内容：</p>
<pre>序章
第一章 ABCDEF
第二章 GHIJKL
第三章 …………
终章</pre>
<p>这种内容我们都很熟悉，你有没有想过，用什么办法可以把这些内容一次过查找出来呢？</p>
<p>为了简化，我们先来看这个部分。</p>
<pre>第一章
第二章
第三章</pre>
<p>可以看到，这些内容有着极高的相似性，由“第”，“章”开头和结尾，中间有着一些数字。如果我们能用一个什么符号来代表中间的所有字，比如一个圆点“.”，不就可以用这样的方式来查找出所有这样的内容了吗。</p>
<pre>第.章</pre>
<p>很早之前，就有人发明了一套完整的方案，让我们可以用各种不同的符号来达到这种目的，那就是我们将要了解的正则表达式。</p>
<p>正则表达式作为一种描述字符的方案，在大量软件、编程语言中都有所运用，而在这些不同的平台上，正则表达式的使用方式又往往会有或多或少的差异，在某个平台上管用的表达式，换个地方可能就要改改才能正确运行。那么在这篇文章里，我们主要是讲Sigil中的正则表达式，至于推广应用，就要靠大家去查找资料了。</p>
<h3>1. 元字符</h3>
<p>我们前面提到，正则表达式一个重要作用就是用特别的符号来代表一类字符，而这些符号就叫做“元字符”。这些元字符在大多数环境下都是通用的。</p>
<p>注意，元字符中所有符号都是半角符号，也就是通常说的英文符号。</p>
<p>以下是一些常见的元字符，实际上还有更多。这些元字符都经过测试，在Sigil下有效。</p>
<table>
    <tbody><tr><td>符号</td><td>意义</td><td>说明</td></tr>
    <tr><td>.</td><td>任意一个字符</td><td>
            <p>最简单的元字符，匹配任意字符，但不包括换行符“\n”。</p>
    </td></tr>
    <tr><td>\</td><td>转义</td><td>
            <p>把元字符改变为普通字符，或者把某些普通字符转变为元字符。</p>
            <p>比如，“\.”就是代表普通的点号，不代表其他字符。</p>
    </td></tr>
    <tr><td>\s</td><td>空白字符</td><td>
            <p>半角空格、制表符等空白字符。在Sigil中还能匹配到换行符“\n”和空白行，使用要注意。</p>
            <p>注意，不能匹配到全角空格。</p>
    </td></tr>
    <tr><td>\t</td><td>制表符</td><td><p>匹配制表符。</p></td></tr>
    <tr><td>\n</td><td>换行符</td><td>
            <p>表示文章的换行，这是一个不可见符号，在例子中，这个符号在“_”的位置。</p>
            <p>aaa\n</p>
            <p>bbb</p>
            <p>你能够通过“\n”找到换行符，但不能够插入换行符。要在替换结果中换行，需要用“\r”。</p>
    </td></tr>
    <tr><td>\r</td><td>回车</td><td>
            <p>代表一个回车符。这个符号不会在文本中出现，因此不能查找到。</p>
            <p>但是如果你需要在查找结果中插入一个换行，那么就要用“\r”。</p>
            <p>注意，插入后在文本中出现的仍然会是“\n”而不是“\r”。</p>
    </td></tr>
    <tr><td>\d</td><td>任意一个阿拉伯数字</td><td><p>也就是可以代表0~9中的任意一个。</p></td></tr>
    <tr><td>\D</td><td>任意一个非阿拉伯数字
    </td><td><p>0~9以外的字符，同样的，不包括换行符“\n”</p></td></tr>
    <tr><td>^</td><td>行首</td><td>
            <p>即一行的开头。Sigil中不能单独使用，要配合其他字符。</p>
            <p>比如，“^a”表示在行首的“a”，能匹配到第一行和第三行的字母“a”。第二行因为行首是空格，因此匹配不到。</p>
            <p>abc</p>
            <p>&nbsp;&nbsp;abc</p>
            <p>abc</p>
    </td></tr>
    <tr><td>$</td><td>行尾</td><td>
            <p>表示任意一行的结尾，不包括换行符。在Sigil中不能单独使用。</p>
            <p>比如，“c$”表示位于行尾的“c”,能够匹配到第一行和第二行的字母“c”。</p>
            <p>abc</p>
            <p>abc</p>
            <p>abcd</p>
    </td></tr>
    <tr><td>+</td><td>一或更多</td><td>
            <p>表示一个或更多。必须配用其他字符使用。添加在一个字符后面，表示一个或更多个该字符。</p>
            <p>相当于“{1,}”</p>
            <p>比如，“a+”表示一个以上的“a”，以下例子都能匹配到。</p>
            <p>a</p>
            <p>aa</p>
            <p>aaa</p>
    </td></tr>
    <tr><td>?</td><td>尽可能少</td><td>
            <p>表示尽可能少。必须配合其他字符使用。</p>
            <p>比如，“accccbb”中“a.*b”匹配到“accccbb”，而“a.*?b”就能只匹配到“accccb”。</p>
            <p>※注意：在某些平台的正则表达式中，这一功能很可能由“-”减号提供。</p>
    </td></tr>
    <tr><td>|</td><td>或</td><td>
            <p>一个逻辑选择符。</p>
            <p>“aa|bb”既可以匹配到“aa”也可以匹配到“bb”。</p>
            <p>可以用到多个选项中，比如“aa|bb|cc”。</p>
            <p>“1|2|3”相当于“[123]”。</p>
    </td></tr>
    <tr><td>*</td><td>尽可能多</td><td><p>即无或更多。相当于“{0,}”</p></td></tr>
    <tr><td>{n,m}</td><td>个数范围</td><td>
            <p>表示匹配项的个数范围。</p>
            <p>比如，“a{3}”表示“aaa”，“a{2,4}”表示“aa”或“aaa”或“aaaa”，“a{1,}”表示一个以上的“a”。</p>
            <p>注意，“a{,2}”应该表示两个以下的“a”，但是这种写法在Sigil中无效，要写成“a{0,2}”。</p>
    </td></tr>
    <tr><td>[]</td><td>包含</td><td>
            <p>“[]”本身匹配一个字符。</p>
            <p>比如，“[abc]”匹配“a”、“b”或“c”。通常不分顺序，“<abc>”和“<bca>”一样。</bca></abc></p>
            <p>“[]”中用“-”表示范围，“[a-z]”表能匹配到“a”到“z”全部26个字母之一。</p>
            <p>比如，“&lt;0-9&gt;”和“\d”是一样的，但是“\d”速度更快。</p>
            <p>如果要在“[]”中匹配“-”本身，把“-”写在最前面，或者把它转义“\-”。</p>
            <p>比如“[-0-9]”，就能匹配所有阿拉伯数字和“-”。</p>
        </td></tr>
        <tr><td>[^]</td><td>不包含</td><td>
                <p>“[]”的逆操作。</p>
                <p>比如“a[^b]c”，能匹配到第二行，第三行。</p>
                <p>abc</p>
                <p>adc</p>
                <p>afc</p>
                <p>注意，因为“[]”中符号是无序的，因此如果要排除字符串，要用其他方法。</p>
        </td></tr>
        <tr><td>()</td><td>捕获组</td><td>
                <p>“(abc)”表示把“abc”分为一组。分组后可以配合其他元字符使用。一个组称为一个捕获组。</p>
                <p>比如，“(abc)+”就是一个或以上“abc”组合的意思。</p>
                <p>捕获组中的内容会被记录并编号，可以通过“\0”“\1”这种形式来引用。</p>
        </td></tr>
        <tr><td>(?:)</td><td>分组/非捕获组</td><td>
                <p>作用上与“()”类似，能把内容分为一组，但“(?:)”仅有分组功能，不记录匹配内容。也就是说，无法通过“\0”“\1”等方式引用。</p>
                <p>此元字符虽然消耗的资源更少，速度更快，在简单应用中可能体验不到与“()”的区别。</p>
        </td></tr>
        <tr><td>\0，\1，\2...</td><td>反向引用</td><td>
                <p>配合分组使用，引用一个分组。</p>
                <p>比如，在查找时有分组“(abc)”，那么“\1”就代表“abc”。有分组“a(bc)(de)f”，那么“\0”代表“abcdef”，“\1”代表“bc”，“\2”代表“de”。如此类推。</p>
                <p>嵌套也是一样的，比如“(abc(def))”，“\1”代表“abcdef”，“\2”代表“def”。</p>
                <p>同样地，也能在查找时应用。</p>
                <p>比如有字符串“abc111abc”，那么表达式“(abc).*\1”就能匹配到所有内容。</p>
                <p>注：在其他平台中，可能使用的是$0，$1等表示方法。</p>
        </td></tr>
        <tr><td>(?s)</td><td>多行匹配</td><td>
                <p>放在表达式的最前端，使得“.”可以匹配到“\n”，从而实现跨行匹配。</p>
                <p>比如以下例子：</p>
                <p>&lt;div&gt;&lt;/div&gt;</p>
                <p>&lt;h1&gt;&lt;/h1&gt;</p>
                <p>&lt;div&gt;&lt;/div&gt;</p>
                <p>使用正则表达式“&lt;div&gt;.*&lt;/div&gt;”一次只能匹配到第一行或者第三行。</p>
                <p>而使用“(?s)&lt;div&gt;.*&lt;/div&gt;”则能一次性匹配到第一行到第三行所有内容。</p>
                <p>注：这是Sigil特有元字符，其他平台有另外的方法实现该功能。</p>
                <p>注2：此前缀和勾选“DotAll”效果一致。</p>
        </td></tr>
        <tr><td>(?U)</td><td>最少匹配</td><td>
                <p>放在表达式的最前端，使得整个正则表达式实现最少匹配。</p>
                <p>比如以下例子：</p>
                <p>&lt;div&gt;AAA&lt;div&gt;BBB&lt;/div&gt;CCC&lt;/div&gt;</p>
                <p>正则表达式“&lt;div&gt;.*&lt;/div&gt;”会匹配到整个句子。</p>
                <p>而“(?U)&lt;div&gt;.*&lt;/div&gt;”只会匹配到“&lt;div&gt;AAA&lt;div&gt;BBB&lt;/div&gt;”。</p>
                <p>注：这是Sigil特有元字符，其他平台有另外的方法实现该功能。</p>
                <p>注2：此前缀和勾选“Minimal Match”效果一致。</p>
        </td></tr>
    </tbody></table>
    <h3>2. 常用正则表达式</h3>
    <p>在这一部分，我们回来看一些很常用的正则表达式，这些表达式往往是更复杂表达式的组成部分。</p>
    <h4>2.1 所有字符</h4>
    <pre>.*</pre>
    <p>匹配所有内容。“.”代表一个字符，“*”代表任意多个，因此“.*”代表“所有字符”。比如</p>
    <pre>&lt;div&gt;.*&lt;/div&gt;</pre>
    <p>表示&lt;div&gt;标签内的所有内容，可以依次匹配到下列各项</p>
    <pre>&lt;div&gt;AAACCCC&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;！！！！AAAAACCCC啊啊啊啊&lt;/div&gt;</pre>
    <p>但不能跨行，这样是匹配不到的。</p>
    <pre>&lt;div&gt;
AAAAAA
&lt;/div&gt;</pre>
    <p>如果要跨行，需要使用“(?s)”。</p>
    <h4>2.2 空白行</h4>
    <pre>^[ \t  ]*$\n</pre>
    <p>匹配空白行的典型写法。可以匹配无内容的行，只有空格的行，只有制表符的行或者空格和制表符混合排列的行。[]中包括的分别是空格“ ”，制表符“\t”和全角空格“　”。也可以根据需要添加更多的字符。</p>
    <h4>2.3 行尾空白字符</h4>
    <pre>[&nbsp;\t&nbsp;&nbsp;]+$</pre>
    <p>匹配出现在行尾的空白字符，比如空格。思路和2.2一致，使用“$”把搜查范围限定在结尾，使用了符号“+”确保最少有一个空白字符，否则会查找失败。</p>
    <h4>2.4 压缩重复符号</h4>
    <p>查找</p>
    <pre>。+</pre>
    <p>替换</p>
    <pre>。</pre>
    <p>很容易理解，把一个以上的“。”，换成一个“。”，从而达到压缩重复符号的目的。可以灵活改变，压缩各种重复的字符。配合2.2的查找空白行，也能实现压缩空白行。</p>
    <h3>3. 应用实例</h3>
    <p>在这一部分，我们会看一些Sigil使用过程中实际会用到的例子，方便各位了解正则表达式的使用。</p>
    <h4>3.1 添加标签</h4>
    <p>你打算为所有的图片添加一个&lt;div&gt;，并且class为images</p>
    <table>
        <tbody><tr><td>原语句</td><td>&lt;img src="Images/001.jpg" /&gt;</td></tr>
        <tr><td>目标语句</td><td>&lt;div class="images"&gt;&lt;img src="Images/001.jpg" /&gt;&lt;/div&gt;</td></tr>
        <tr><td>使用元字符</td><td>. ，* ，\0</td></tr>
        <tr><td>查找</td><td>&lt;img.*/&gt;</td></tr>
        <tr><td>替换</td><td>&lt;div class="images"&gt;\0&lt;/div&gt;</td></tr>
    </tbody></table>
    <p>解说：</p>
    <p>查找以“&lt;img”开头，“/&gt;”结尾的所有句子，这个表达式默认分组为“0”,因此可以用“\0”来引用。</p>
    <p>如果你的文本中图片语句必定是独立一行的，可以直接使用“&lt;img.*”这样的简单句子。</p>
    <p>同样的，也可以通过“/&gt;”后面是否紧跟换行符“\n”来判断图片是否独立一行，从而实现不同位置图片的匹配。</p>
    <p>扩展：</p>
    <p>同样的，你可以用这个方法为各种内容很方便的添加标签，如果你常常用到这样的替换，不要忘记善用Sigil的搜索模板功能。</p>
    <h4>3.2 拼接断行</h4>
    <p>在一些文本中，会存在断行，我们要把这些断行重新拼接起来。</p>
    <table>
        <tbody><tr><td>原文本</td>
            <td><pre>床前
明月光，
疑是地上
霜。
举头望
明月，
低头思故乡。</pre></td></tr>
        <tr><td>目标文本</td>
            <td><pre>床前明月光，
疑是地上霜。
举头望明月，
低头思故乡。</pre></td></tr>
        <tr><td>使用元字符</td><td>[^]，\n</td></tr>
        <tr><td>查找</td><td>([^，。])$\n</td></tr>
        <tr><td>替换</td><td>\1</td></tr>
    </tbody></table>
    <p>解说</p>
    <p>其实所谓的断行，就是在不该换行的地方进行了换行，那么只要分析出不该换行的特征就可以了。在这个例子中，换行只应该出现在“，”和“。”后面，因此我们查找前面没有“，”或者“。”的换行，并且将其删除就可以了。</p>
    <p>因为使用的正则表达式会匹配到“\n”前面的一个字符，为了不把这个字符也删除，所以要用“()”把这个字符保护起来。</p>
    <p>扩展</p>
    <p>实际上我们还可以使用“零宽断言”来达到这个效果，写法是“(?&lt;![，。]$)\n”,直接替换为空，零宽断言本身就保护了字符。</p>
    <p>但是作为一个入门应用，我还是先介绍使用“[^]”的方法，关于零宽断言，有兴趣的朋友可以到这个网址了解：</p>
    <a href="http://blog.csdn.net/rcom10002/acle/details/3159359">http://blog.csdn.net/rcom10002/acle/details/3159359</a>
    <h4>3.3 识别章节标题</h4>
    这是很常见的一个需求，我们往往要为章节标题添加&lt;h1&gt;，&lt;h2&gt;之类的标签。通过3.1我们已经了解到如何添加标签，因此这里着重讲解如何识别标题。
    <table>
        <tbody><tr><td>原文本</td>
            <td><pre>序章
第一章 XXXX
第二章 CCCC
第三章 AAAA
终章
后记</pre></td></tr>
        <tr><td>目标文本</td>
            <td><pre>&lt;h1&gt;序章&lt;/h1&gt;
&lt;h1&gt;第一章 XXXX&lt;/h1&gt;
&lt;h1&gt;第二章 CCCC&lt;/h1&gt;
&lt;h1&gt;第三章 AAAA&lt;/h1&gt;
&lt;h1&gt;终章&lt;/h1&gt;
&lt;h1&gt;后记&lt;/h1&gt;</pre></td></tr>
        <tr><td>使用元字符</td><td>. ，* ，()，\1，^，|，{m,n}</td></tr>
        <tr><td>查找</td><td>^((序章|第.{1,3}章|终章|后记).*)</td></tr>
        <tr><td>替换</td><td>&lt;h1&gt;\1&lt;/h1&gt;</td></tr>
    </tbody></table>
    <p>解说</p>
    <p>表达式开始的“^”查找内容必须是每一行的开头，这样才不会匹配到正文中的“第N章”之类的内容。当然，还是无法完全排除匹配到正文的可能性，因此要注意替换次数，如果次数和章节数目不符，就要留意了。</p>
    <p>通过“|”的使用，我们可以在一个表达式中就匹配到所有的内容，要善用“|”。“第.{1,3}章”是一个保险，最多匹配到“第九十九章”这样的字符串，在实际使用中，往往只需要写“第.章”。如果是“第1章”这样的，就可以用“第\d章”来更精准的匹配。</p>
    <h3>3.5 自动插入&lt;title&gt;&lt;/title&gt;内容</h3>
    <table>
        <tbody><tr><td>原文本</td>
            <td><pre>&lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;XXXX&lt;/h1&gt;</pre></td></tr>
        <tr><td>目标文本</td>
            <td><pre>&lt;title&gt;XXXX&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;XXXX&lt;/h1&gt;</pre></td></tr>
        <tr><td>使用元字符</td><td>. ，* ，()，\1，\2，(?s)，\n，\r</td></tr>
        <tr><td>查找</td><td>(?s)&lt;title&gt;&lt;/title&gt;\n(.*&lt;h1&gt;(.*)&lt;/h1&gt;)</td></tr>
        <tr><td>替换</td><td>&lt;title&gt;\2&lt;/title&gt;\r\1</td></tr>
    </tbody></table>
    <p>解说</p>
    <p>通说“()”的捕获群获取所需要的字符串，然后以逆向引用来达到插入内容的目的。</p>
    <p>使用Sigil的前置符“(?s)”使得“.*”可以匹配到换行符“\n”，因此表达式可以匹配到“&lt;/head&gt;...&lt;h1&gt;”之间的所有内容。</p>
    <p>捕获组1保留&lt;title&gt;以外的所有内容，以便稍后恢复，捕获组2获取&lt;h1&gt;中的内容，插入到&lt;title&gt;中去。</p>
    <p>这个操作在Sigil中比较有用，因为Sigil默认是不会填写&lt;title&gt;内容的。</p>		</div>


</div></div></div></body><style type="text/css" id="14990918521"></style></html>
